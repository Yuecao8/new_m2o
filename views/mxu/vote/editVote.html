<main class="main-form-wrap article-form-wrap edit-vote-warp" my-loading="vm.info_loading"><nav class="hoge-nav"><div class="hoge-table-add"><div class="hoge-edit-head"><span class="back-list" ng-click="vm.goBackList()" ng-class="{'no-event':vm.noEdit}"><span>投票</span> <span class="symbol">></span> </span><em ng-if="!vm.hotFlag">{{vm.is_edit}}投票</em><span ng-show="vm.draftLoading" style="color:#a5a5a5"><img src="../assets/images/mxu/news/loading.gif" alt=""> 正在保存 </span><span ng-show="vm.draftLoadingOn" style="color:#a5a5a5"><i class="typeface-alert_wancheng2"></i> 已保存</span><div class="edit-width-status" ng-show="vm.param.id"><span class="content-pendingAudit" ng-if="vm.editStatus==1">待审核</span> <span class="content-audited" ng-if="vm.editStatus==2">已审核</span><span class="content-repulsed" ng-if="vm.editStatus==4">已打回</span> <span class="content-repulsed" ng-if="vm.editStatus==5">审核中</span></div></div></div></nav><div class="form-content hoge-flex is-no-event"><div><aside class="left-aside hoge-radius" ng-class="{'no-event':vm.noEdit}"><div class="draft-left hoge-radius"><div class="side_form_fixed hoge-radius" style="z-index:1001"><div class="hoge-border" ng-class="{'template-list':vm.templateState==true,'other':vm.templateState==false}" style="z-index:1000" scroll-aside><div class="tab-content"><div class="hoge-radius tab-pane animated fadeIn text-muted active" id="attr"><content-attr dropdown-show="vm.showDropdown" content-param="vm.contentParam" vote-type="'voteEdit'"></content-attr></div></div></div></div></div></aside></div><div class="edit-bg-vote" ng-class="{'phone-edit-bg':vm.mobile}"><div class="main-form-content" ng-class="{'phone-form-content':vm.mobile}"><div class="content" ng-class="{'phone-content':vm.mobile}"><div class="draft-box" ng-if="vm.isNew && vm.draftDown"><span class="draft-tip">{{vm.draftTip}}</span> <span class="draft-del" ng-if="!vm.isDel" ng-click="vm.delDraft()">撤销</span></div><div class="content-form-title" ng-class="{'no-event':vm.noEdit}"><div class="title-box"><input type="text" name="title" autocomplete="off" placeholder="请输入投票标题" maxlength="60" ng-model="vm.voteInfo.title"><content-title-tip tip-top="55" tip-title="vm.voteInfo.title" top="0"></content-title-tip></div></div><div class="content-box"><div class="content-operation-box" ng-show="!vm.showSortBox"><input type="checkbox" ng-checked="vm.allChecked() && vm.normaOptionList.length" ng-click="vm.toggleAll()"><span>全选</span> <button class="btn delete-btn" ng-show="vm.checkList.length>0" ng-click="vm.allDeleteOption()">删除</button> <button class="btn group-btn" ng-show="vm.checkList.length>0 && vm.is_group && vm.groupList.length >1" ng-click="vm.goMobileGroup()">分组</button> <button class="btn sort-btn" ng-click="vm.sortOption()">排序</button> <span class="senior" ng-click="vm.toggleSenior()">{{vm.is_senior?'取消高级模式':'高级模式'}}</span> <span class="senior group-span" ng-click="vm.toggleGroup()">{{vm.is_group?'关闭分组':'开启分组'}}</span></div><div class="option-sort-box" ng-show="vm.showSortBox"><i class="fa typeface-login_tishi"></i> <span>排序功能已开启，拖动可排序~</span> <button class="btn pull-right m-r-sm sort-btn cancel-sort-btn" ng-click="vm.cancelSortBtn()">取消</button> <button class="btn pull-right m-r-sm sort-btn save-sort-btn" ng-click="vm.saveSortBtn()">保存</button></div><div class="group-box" ng-show="vm.is_group"><div class="pre-icon" ng-click="vm.preItem()"><i class="fa typeface-pagination_shangyiye"></i></div><div class="middle-box"><div class="middle-left-box"><div class="all-width-box" style="display:flex"><div class="group-list-box" ng-repeat="(index,item) in vm.groupList track by $index"><span class="group-list" ng-class="{'choose-item':(vm.highlighted && vm.chooseIndex == index) || vm.chooseIndex == index}" ng-dblclick="vm.editGroupName(item,index)" ng-click="vm.getCurrentOpt(item,index)" ng-show="vm.currentIndex != index || !vm.editInput" title="{{item.name}}">{{item.name}}</span> <i class="keywords-icon-del typeface-alert_cuowu" ng-click="vm.del(item)" ng-show="vm.currentIndex != index || !vm.editInput"></i> <input type="text" ng-model="vm.editName" maxlength="10" ng-blur="vm.editKey(1)" ng-keyup="vm.editKey($event)" class="editInput" ng-show="vm.currentIndex == index && vm.editInput"></div><input id="input-keyword-add" maxlength="10" class="input-keyword-add" type="text" ng-model="vm.key" ng-if="vm.add" ng-blur="vm.createKey(1)" ng-keyup="vm.createKey($event)" ng-style="{'width':vm.width+ 'px','maxWidth':'120px',}"></div></div><div class="add-group" ng-click="vm.getFocus()"><i class="fa typeface-form_zengjia"></i></div><div class="sort-group" ng-click="vm.sortGroup()">排序</div></div><div class="next-icon" ng-click="vm.nextItem()"><i class="fa typeface-pagination_xiayiye"></i></div></div><div class="content-option-box"><span class="tip-text">投票保存后，默认开启投票，但必须插入文稿进行发布中才可生效。投票将统计该投票在各个渠道的结果总和。</span><div class="options" ng-show="!vm.is_senior" ui-sortable="vm.optionSortableOpt" ng-model="vm.normaOptionList"><div class="option-item" ng-repeat="item in vm.normaOptionList track by $index"><i class="fa fa-bars" ng-if="vm.showSortBox"></i> <input type="checkbox" ng-class="{'no-event':vm.noEdit}" ng-if="!vm.showSortBox" ng-checked="vm.itemCheck(item)" ng-click="vm.toggle(item)"><span>选项{{$index+1}}</span> <input class="option-input option-content" ng-class="{'no-event':vm.noEdit}" type="text" placeholder="输入选项标题" ng-model="item.title"> <input class="option-input vote-num-input" ng-class="{'no-event':vm.noEdit}" type="text" onkeyup='value=value.replace(/\D/g,"")' placeholder="不填默认为0" ng-model="item.base_num"> <i class="fa typeface-form_shanchu" ng-class="{'no-event':vm.noEdit}" ng-click="vm.optionDel(item)"></i><span class="base-num">票数基数</span></div></div><input type="file" id="up-pic" class="up-pic" nv-file-select="" uploader="vm.optionUploader" accept="image/gif,image/jpeg,image/png,image/psd,image/tiff,image/bmp"><div class="high-options" ng-show="vm.is_senior" ui-sortable="vm.optionSortableOpt" ng-model="vm.normaOptionList"><div class="high-option-item" ng-repeat="item in vm.normaOptionList track by $index"><div class="check-title-box"><input type="checkbox" ng-if="!vm.showSortBox" ng-class="{'no-event':vm.noEdit}" ng-checked="vm.itemCheck(item)" ng-click="vm.toggle(item)"> <i class="fa fa-bars" ng-if="vm.showSortBox"></i> <span>选项{{$index+1}}</span></div><div class="option-img-box" ng-class="{'no-event':vm.noEdit}" ng-click="vm.upOptionImg(item)"><i class="typeface-form_zengjia" ng-if="!item.src"></i><p class="up-text" ng-if="!item.src">点击上传图片</p><img src="{{item.src}}?imageView/0/h/200/w/180" alt=""></div><div class="option-info-box" ng-class="{'no-event':vm.noEdit}"><input class="info-input title-input" type="text" placeholder="输入选项标题" ng-model="item.title"> <textarea class="info-input intro-input" name="" cols="30" rows="10" placeholder="输入选项描述" ng-model="item.brief"></textarea> <input class="info-input base-num-input" type="text" onkeyup='value=value.replace(/\D/g,"")' placeholder="不填默认为0" ng-model="item.base_num"> <span class="base-num">票数基数</span></div><div class="operation-box" ng-class="{'no-event':vm.noEdit}"><i class="fa typeface-form_shanchu" ng-click="vm.optionDel(item)"></i> <i class="fa typeface-form_paixu" ng-click="vm.optionSort(item)" ng-if="!vm.is_senior"></i></div></div></div><div class="add-option-box" ng-class="{'no-event':vm.noEdit}"><i class="typeface-form_zengjia" ng-click="vm.addOption()"></i> <span class="add-text" ng-click="vm.addOption()">添加选项</span></div></div></div></div><div class="footer-btn-box" ng-class="{'no-event':vm.noEdit}"><button class="footer-btn preview-btn" ng-click="vm.votePreview()">预览</button> <button class="footer-btn save-btn" ng-click="vm.save('0')" ng-disabled="vm.clicked === '1'">保存</button> <button class="footer-btn cancel-btn" ng-click="vm.cancelForm()">取消</button></div></div></div><div class="right-aside" ng-class="{'no-event':vm.noEdit}"><div class="right-aside-content"><div class="contain-default" style="padding-bottom:22px"><div class="form-contain"><span class="label-name">模式：</span> <label class="radio-inline vote-radio-style" style="margin-bottom:2px"><input class="vote-radio" ng-model="vm.voteInfo.option_type" type="radio" value="1">单选</label> <label class="radio-inline" style="margin-bottom:2px"><input class="vote-radio" ng-model="vm.voteInfo.option_type" type="radio" value="2">多选</label></div></div><div class="contain-default" ng-show="vm.voteInfo.option_type == 2"><div class="form-contain"><div class="open-box"><span class="open-span">最少：</span> <input class="time-interval-input vote-num" onkeyup='value=value.replace(/\D/g,"")' ng-blur="vm.minOption()" ng-model="vm.voteInfo.option_min" type="text"> <span>项</span></div><div class="open-box"><span class="open-span">最多：</span> <input class="votes-limit-input" type="text" onkeyup='value=value.replace(/\D/g,"")' ng-blur="vm.maxOption()" ng-model="vm.voteInfo.option_max"> <span>项</span></div></div></div><div class="contain-default date-height"><div class="form-contain"><span class="label-name">开始日期：</span><div class="time-box"><div class="time-date"><input class="date-input" placeholder="不填为即刻生效" class="form-control" ng-model="vm.startTime_hour" data-date-format="yyyy-MM-dd" data-date-type="number" data-autoclose="1" data-icon-left="fa fa-chevron-left" data-icon-right="fa fa-chevron-right" name="date" autocomplete="off" data-min-date="today" bs-datepicker> <i class="icon-biaodan"></i></div><div class="time-minutes"><input class="date-input form-control" placeholder="不填默认零点" ng-model="vm.startTime_hour" data-icon-left="fa fa-chevron-left" data-icon-right="fa fa-chevron-right" data-time-format="HH:mm" data-time-type="number" data-autoclose="1" placement="bottom-right" name="time" autocomplete="off" bs-timepicker> <i class="icon-shijian"></i></div></div></div></div><div class="contain-default date-height"><div class="form-contain"><span class="label-name">截止日期：</span><div class="time-box"><div class="time-date"><input class="date-input" placeholder="不填为永久有效" class="form-control" ng-model="vm.endTime_hour" data-date-format="yyyy-MM-dd" data-date-type="number" data-autoclose="1" data-icon-left="fa fa-chevron-left" data-icon-right="fa fa-chevron-right" name="date" autocomplete="off" data-min-date="today" bs-datepicker> <i class="icon-biaodan"></i></div><div class="time-minutes"><input class="date-input form-control" placeholder="不填默认零点" ng-model="vm.endTime_hour" data-icon-left="fa fa-chevron-left" data-icon-right="fa fa-chevron-right" data-time-format="HH:mm" data-time-type="number" data-autoclose="1" placement="bottom-right" name="time" autocomplete="off" bs-timepicker> <i class="icon-shijian"></i></div></div></div></div><div class="contain-default"><div class="form-contain"><div class="switch-box login-switch"><span class="label-name switch-span">登录限制：</span> <label class="ui-switch switch-r switch-position"><span class="switch-open">开</span> <span class="switch-close">关</span> <input type="checkbox" ng-checked="vm.voteInfo.login_limit" ng-click="vm.loginChecked()"> <i></i></label></div><div class="open-box login-box" ng-show="vm.voteInfo.login_limit"><span class="open-span">间隔时长：</span> <input class="time-interval-input" onkeypress="((event.keyCode<48||57<event.keyCode)&&46!=event.keyCode||/\.\d\d{2}$/.test(value))&&(event.returnValue=!1)" type="text" placeholder="不填为无限制" ng-model="vm.voteInfo.login_limit_time"> <span>小时</span></div><div class="open-box login-box" ng-show="vm.voteInfo.login_limit"><span class="open-span">票数限制：</span> <input class="votes-limit-input" onkeyup='this.value=this.value.replace(/\D/g,"")' onafterpaste='this.value=this.value.replace(/\D/g,"")' type="text" placeholder="1" ng-model="vm.voteInfo.login_limit_num"> <span>票</span></div></div></div><div class="contain-default"><div class="form-contain"><div class="switch-box login-switch"><span class="label-name switch-span">实名认证：</span> <label class="ui-switch switch-r switch-position"><span class="switch-open">开</span> <span class="switch-close">关</span> <input type="checkbox" ng-checked="vm.voteInfo.certification" ng-click="vm.certificationChecked()"> <i></i></label></div></div></div><div class="contain-default"><div class="form-contain"><div class="switch-box" ng-class="{'switch-box-bottom':!vm.voteInfo.device_limit}"><span class="label-name switch-span">设备限制：</span> <label class="ui-switch switch-r switch-position"><span class="switch-open">开</span> <span class="switch-close">关</span> <input type="checkbox" ng-checked="vm.voteInfo.device_limit" ng-click="vm.deviceChecked()"> <i></i></label></div><div class="open-box" ng-show="vm.voteInfo.device_limit"><span class="open-span">间隔时长：</span> <input class="time-interval-input" onkeypress="((event.keyCode<48||57<event.keyCode)&&46!=event.keyCode||/\.\d\d{2}$/.test(value))&&(event.returnValue=!1)" type="text" placeholder="不填为无限制" ng-model="vm.voteInfo.device_limit_time"> <span>小时</span></div><div class="open-box" ng-show="vm.voteInfo.device_limit"><span class="open-span">票数限制：</span> <input class="votes-limit-input" onkeyup='this.value=this.value.replace(/\D/g,"")' onafterpaste='this.value=this.value.replace(/\D/g,"")' type="text" placeholder="1" ng-model="vm.voteInfo.device_limit_num"> <span>票</span></div></div></div><div class="contain-default"><div class="form-contain"><div class="switch-box" ng-class="{'switch-box-bottom':!vm.voteInfo.ip_limit}"><span class="label-name switch-span">IP限制：</span> <label class="ui-switch switch-r switch-position"><span class="switch-open">开</span> <span class="switch-close">关</span> <input type="checkbox" ng-checked="vm.voteInfo.ip_limit" ng-click="vm.ipChecked()"> <i></i></label></div><div class="open-box" ng-show="vm.voteInfo.ip_limit"><span class="open-span">间隔时长：</span> <input class="time-interval-input" onkeypress="((event.keyCode<48||57<event.keyCode)&&46!=event.keyCode||/\.\d\d{2}$/.test(value))&&(event.returnValue=!1)" type="text" placeholder="不填为无限制" ng-model="vm.voteInfo.ip_limit_time"> <span>小时</span></div><div class="open-box" ng-show="vm.voteInfo.ip_limit"><span class="open-span">票数限制：</span> <input class="votes-limit-input" onkeyup='this.value=this.value.replace(/\D/g,"")' onafterpaste='this.value=this.value.replace(/\D/g,"")' type="text" placeholder="1" ng-model="vm.voteInfo.ip_limit_num"> <span>票</span></div></div></div><div class="contain-default"><div class="form-contain"><div class="switch-box result-switch"><div class="label-title title-length-5">结果隐藏<div class="question-box"><i class="subtitle-i typeface-form_tishi"></i><div class="question-hover">用户进行投票后，才展示结果<span class="question-tip"></span></div></div>:</div><label class="ui-switch switch-r switch-position"><span class="switch-open">开</span> <span class="switch-close">关</span> <input type="checkbox" ng-checked="vm.voteInfo.hide_result" ng-click="vm.resultChecked(item)"> <i></i></label></div></div></div></div></div></div><m2o-footer is-color="true" is-show="1"></m2o-footer></main><hot-footer ng-if="vm.hotFlag" hot-id="vm.id" hot-status="vm.status" this-status="vm.thisStatus" hot-title="vm.title" type="vm.type" this-type="vm.thisType" button-id="vm.ButtonId"></hot-footer>