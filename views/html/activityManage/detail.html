
<div class="mxu_activityManageDetail_list">
    <div class="p-v-md">
        <div class="hoge-edit-head">
            <div class="hoge-return-body" onclick="history.back(-1)">
                <i class="fa typeface-menu_fanhuiliebiao" ></i>
                <span class="return-tip">返回列表</span>
            </div>
            <em class="title-w">活动详情</em>
        </div>
        <button class="btn hoge-btn-blue pull-right" ng-click="vm.newActivity()">新增作品</button>
    </div>
    <div class="box flex-item">
        <!-- list -->
        <div class="list_contain hoge-table-contain white" style="border:none">
            <div class="hoge-table-search activity-title">
                <span>活动作品</span>  
                <div class="pull-right activity-title-tip ">
                    <span class="p-r-20">参与人数：暂无</span>  
                    <span>作品总数：{{vm.pageOptions.total}}</span>  
                </div>
                

            </div>
            <!-- 筛选 -->
            <div class="hoge-table-search">
                <!-- 状态下拉 -->
                <div class="btn-group dropdown hoge-dropdown">
                    <button class="btn btn-sm dropdown-toggle" data-toggle="dropdown">
                        <span class="dropdown-label">{{vm.statusName}}</span>
                        <span class="caret"></span>
                    </button>
                    <div class="dropdown-menu text-left text-sm">
                        <a class="dropdown-item" ng-repeat="status in vm.statusTypeArr" ng-click="vm.chooseStatus(status)">{{status.name}}</a>
                    </div>
                </div>

                <!--时间下拉-->
                <div class="btn-group dropdown hoge-dropdown">
                    <button class="btn btn-sm dropdown-toggle" style="padding-right: 24px !important;" data-toggle="dropdown">
                        <span class="dropdown-label">{{vm.timeName}}</span>
                        <span class="caret"></span>
                    </button>
                    <div class="dropdown-menu text-left text-sm w142" ng-class="{'disOpen':vm.open}">
                        <a class="dropdown-item" ng-repeat="time in vm.timeArr track by $index" ng-click="vm.chooseTime(time)" ng-class="{out: vm.timeArr.length - 1 === $index}">
                            {{time.name}}
                            <input id="datepicker" ng-if="vm.timeArr.length - 1 === $index" date-range-picker ng-model="vm.rangeDate" class="date-picker opacity-0"
                                    type="text" options="vm.options"/>
                        </a>
                    </div>
                </div>
                <!-- 搜索 -->
                <div class="form-group hoge-input-search pull-right">
                    <input type="text" placeholder="搜索..." ng-keypress="vm.keyPress($event)" ng-model="vm.title">
                    <i class="fa typeface-searchbar_sousuo" ng-click="vm.search()"></i>
                </div>
            </div>

            <!-- 列表 -->
            <hoge-error hight-num="'277px'" arr-length="vm.dataList.length" load="vm.loading"></hoge-error>
            <!-- 列表头部 -->
            <div class="table_header hoge-table-header" ng-show="vm.dataList.length">
                <div class="wrap flex-item list-head-box">
                    <div class="list-ctr"></div>
                    <div class="list-title flex-one">作品</div>
                    
                    <div class="list-author">评分人数</div>
                    <!-- <div class="list-time">投稿时间</div> -->
                    <div class="list-time cursor-pointer" ng-click="vm.doSort('subscribe_num')">
                            投稿时间
                        <div class="icon_sort">
                            <i  class="fa fa-sort-asc" ng-class="{none:vm.sort_key=='subscribe_num'&& vm.sort_type=='desc',top:vm.sort_key=='subscribe_num'&& vm.sort_type=='asc'}"></i>
                            <i  class="fa fa-sort-desc" ng-class="{bottom:vm.sort_key=='subscribe_num'&& vm.sort_type=='desc',none:vm.sort_key=='subscribe_num'&& vm.sort_type=='asc'}"></i>
                        </div>
                    </div>
                    <div class="list-status">状态</div>
                    <div class="list-score cursor-pointer" ng-click="vm.doSort('share_num')">当前得分
                        <div class="icon_sort">
                            <i  class="fa fa-sort-asc" ng-class="{none:vm.sort_key=='share_num'&& vm.sort_type=='desc',top:vm.sort_key=='share_num'&& vm.sort_type=='asc'}"></i>
                            <i  class="fa fa-sort-desc" ng-class="{bottom:vm.sort_key=='share_num'&& vm.sort_type=='desc',none:vm.sort_key=='share_num'&& vm.sort_type=='asc'}"></i>
                        </div>
                    </div>
                    
                    <div class="list-opera"></div>
                </div>
            </div>
            <!-- 列表主体 -->
            <div class="list white border-bottom-radius" ng-model="vm.dataList" ng-if="vm.dataList && vm.dataList[0]"> 
                <div class="list-item hoge-item-border flex-item"
                    ng-repeat="(idxs,nor) in vm.dataList track by $index"
                    ng-class="{'border-blue':vm.itemCheck(nor)}">
                    <div class="list-ctr">
                        <label class="checkbox-inline">
                            <input type="checkbox" value="option1" ng-checked="vm.itemCheck(nor)" ng-click="vm.toggle(nor)">
                        </label>
                    </div>

                    <div class="list-title flex-one flex-item"> 
                        <div class="img-box">
                            <img ng-src="{{nor.index_pic}}?imageView/0/h/46/w/60" alt="" ng-if="nor.index_pic">
                            <img src="../assets/images/mxu/img_cover.png" ng-if="!nor.index_pic">
                        </div>
                        <div class="list-title-right flex-one">
                            <span class="item-title">{{nor.title}}</span>
                            <div class="item-title-info flex-item">
                                <i class="fa typeface-talking_tupian"></i>
                                <span class="num">{{nor.photo_count}}</span>
                                <span class="author">作者：{{nor.create_user_name}}</span>
                            </div>
                        </div>
                    </div>
                    <div class="list-author">{{nor.committeed_total}}</div>
                    <div class="list-time">{{nor.created_at}}</div>
                    <!-- status -->
                    <div class="list-status">
                        <span class="list-status-item content-gray" ng-if="nor.status==1">待审核</span>
                        <span class="list-status-item content-red" ng-if="nor.status==5">审核中</span>
                        <span class="list-status-item content-green" ng-if="nor.status==2">已审核</span>
                        <span class="list-status-item content-red" ng-if="nor.status==4">已打回</span>
                        <span class="list-status-item content-green" ng-if="nor.status==3">已上网</span>
                        <span class="list-status-item content-gray" ng-if="nor.status==23">已下网</span>
                        <span class="list-status-item content-red" ng-if="nor.status==24">已隔离</span>
                        <span class="list-status-item content-red" ng-if="nor.status==22">不合规</span>
                        <span class="list-status-item content-green" ng-if="nor.status==21">评分中</span>
                        <span class="list-status-item content-green" ng-if="nor.status==20">已评分</span>
                    </div>
                    <div class="list-score">{{nor.average_score}}</div>
                    
                   
                    <div class="list-opera hoge-list-i" ng-mouseenter="vm.showOpera(nor)" ng-mouseleave="vm.hideOpera(nor)">
                        <div class="icon-tool pull-right">
                            <i class="typeface-list_caozuo hoge-list_caozuo"
                                ng-class="{'active-bg':nor.searchShow}"></i>
                            <div class="pull-right list-icon-opera" ng-style="{'bottom': $index*5-110 + 'px','right': '40px'}" ng-class="{'opera-show':nor.searchShow,'opera-hide':!nor.searchShow}">
                                <div class="btn-group">
                                    <!--预览-->
                                    <button class="btn hoge-drop-icon" ng-click="vm.goDetail(nor)">详情</button>
                                    <button class="btn hoge-drop-icon" ng-click="vm.audit(nor)">提审</button>
                                    <button class="btn hoge-drop-icon" ng-click="vm.examine(nor)">审核</button>
                                    <button class="btn hoge-drop-icon" ng-click="vm.goTagError(nor)">标记不合规</button>
                                    <!-- <button class="btn hoge-drop-icon" ng-click="vm.examine(nor)">提交评分</button>
                                    <button class="btn hoge-drop-icon" ng-click="vm.withdraw(nor)">修改评分</button> -->
                                    <button class="btn hoge-drop-icon" ng-if="nor.status==2"  ng-click="vm.goPublish(nor)">上网</button>
                                    <button class="btn hoge-drop-icon" ng-if="nor.status==3" ng-click="vm.godownNet(nor)">下网</button>
                                    <button class="btn hoge-drop-icon" ng-click="vm.withdraw(nor)">打回</button>
                                    <button class="btn hoge-drop-icon" ng-click="vm.delete(nor)">删除</button>
                                    
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                <!--bottom-->
            <div class="list_bottom hoge-table-bottom border-bottom-radius" ng-if="vm.dataList && vm.dataList[0]">
                <div class="btn-group">
                    <label class="checkbox-inline">
                        <input type="checkbox" value="option1" ng-checked="vm.allChecked()" ng-click="vm.toggleAll()">
                        <span class="all-checked">{{'content.select' | translate}}</span>
                    </label>
                </div>
                <div class="btn-toolbar list_bar flex-one btn-box">
                    <div class="btn-group">
                        <!-- <button class="btn btn-comment" ng-click="vm.auditAll()">提审</button> -->
                        <button class="btn btn-comment" ng-click="vm.examineAll()">审核</button>
                        <button class="btn del-btn" ng-click="vm.withdrawAll()">打回</button>
                        <button class="btn btn-comment" ng-click="vm.goPublishAll()">上网</button>
                        <button class="btn btn-comment" ng-click="vm.godownNetAll()">下网</button>
                        <button class="btn btn-comment" ng-click="vm.deleteAll()">删除</button>
                    </div>
                </div>
                <page-nation options="vm.pageOptions" turn-page="vm.changePage()" ng-show="vm.pageOptions.total > 0"></page-nation>
            </div>
        </div>

        <!-- 右侧信息 -->
        <div class="info-box">
            <!-- 图 -->
            <div class="info-box-img-box">
                <!-- 上网 -->
                <div class="internet-access-box">
                    <!-- <img src="http://pic1.win4000.com/wallpaper/c/53cdd1f7c1f21.jpg" alt=""> -->
                    <img ng-src="{{vm.detailInfo.index_pic_url}}" alt="">
                    <div class="internet-access" ng-if="vm.detailInfo.status==1">待审核</div>
                    <div class="internet-access" ng-if="vm.detailInfo.status==5">审核中</div>
                    <div class="internet-access" ng-if="vm.detailInfo.status==2">已审核</div>
                    <div class="internet-access" ng-if="vm.detailInfo.status==4">已打回</div>
                    <div class="internet-access" ng-if="vm.detailInfo.status==3">已上网</div>
                    <div class="internet-access" ng-if="vm.detailInfo.status==23">已下网</div>
                    <div class="internet-access" ng-if="vm.detailInfo.status==24">已隔离</div>
                    <div class="internet-access" ng-if="vm.detailInfo.status==22">不合规</div>
                    <div class="internet-access" ng-if="vm.detailInfo.status==21">评分中</div>
                    <div class="internet-access" ng-if="vm.detailInfo.status==20">已评分</div>
                </div>
            </div>
            <!-- 信息  -->
            <div class="info-content">
                <div class="content-title">{{vm.detailInfo.title}}</div>
                <div class="content-brief" ng-class="{'expand-style':vm.briefOperaExpand}">
                    <span ng-show="!vm.briefOperaExpand">
                        {{vm.detailInfo.brief.substring(0,85)}}
                        <span ng-show="vm.briefMore">...</span>
                    </span>
                    <span ng-show="vm.briefOperaExpand">{{vm.detailInfo.brief}}</span>
                    <span class="hover-text pull-right" ng-show="vm.briefMore" ng-click="vm.expand()">{{vm.briefOperaExpand?'收起':'展开'}}</span>
                </div>
                <div class="info-content-info-box">
                    <div class="info-item">
                        类型：{{vm.detailInfo.type}} 
                    </div>
                    <div class="info-item">
                        时间：{{ vm.detailInfo.start_time}}～{{vm.detailInfo.end_time}}
                    </div>
                    <div class="info-item">
                        评委：{{vm.chooseAuthorArr}}
                    </div>
                </div>
                <div class="review-box showAudit">
                    <div class="label-title">活动审核：</div>
                    <div class="process-nodes flex-item">
                        <div class="node-item" ng-repeat="(ndx,node) in vm.workAudit.showNodes">
                            <div class="other-audits">
                                <div class="node-name">{{node.rangeName}}</div>
                                <div class="node-role flex-item">
                                    <div class="role-img" ng-style="{'min-width': node.range != 0 && 50+'px' ,'width': (node.users.length > 0 && node.users.length *30+'px') || (node.role_departments.length > 0 && node.role_departments.length *30+'px')}">
                                        <img class="avatar-34 usual-img" src="/assets/images/mxu/review/shengao_head_quanbuyonghu@2x.png" alt="" ng-if="node.range==1">
                                        <div class="user-img-box" ng-if="node.range==2" >
                                            <div class="hoge-tip-arrow avatar-34 usual-img" ng-repeat="(idx,user) in node.users | limitTo:3"
                                                    ng-style="{'left':idx*25+'px'}">
                                                <img class="avatar-34" ng-src="{{user.avatar}}" ng-if="user.avatar">
                                                <span class="avatar-34 no-avatar no-avatar-bg{{user.bgColor}}"  ng-if="!user.avatar">{{user.avatarName}}</span>
                                                <div class="box-color text-color pos-rlt" ng-style="{'width': user.name.length * 13+'px','left': user.name.length> 3 && (-(user.name.length -3)*4) -2 + 'px'}">
                                                    <span class="arrow bottom b-white"></span>
                                                    <div class="box-body">{{user.name}}</div>
                                                </div>
                                            </div>
                                            <span class="overflow-user" ng-if="node.users.length >= 4">
                                                <i class="typeface-form_zengjia fa"></i>
                                                <span class="overflow-num">{{node.users.length-3}}</span>
                                            </span>
                                        </div>
                                        <div class="hoge-tip-arrow avatar-34 usual-img" ng-style="{'left':idx*25+'px'}" ng-if="node.range==3" ng-repeat="(idx,user) in node.role_departments">
                                            <img class="avatar-34" src="/assets/images/mxu/review/shengao_head_bumenjuese@2x.png">
                                            <div class="box-color text-color pos-rlt" ng-style="{'width': user.role.name.length * 13+'px','left': user.role.name.length> 3 && (-(user.role.name.length -3)*4) -2 + 'px' }">
                                                <span class="arrow bottom b-white"></span>
                                                <div class="box-body">{{user.role.name}}</div>
                                            </div>
                                        </div>
                                        <div class="avatar-34 ellipsis-box" ng-if=" node.range == 0">
                                            <i class="typeface-list_caozuo"></i>
                                        </div>
                                    </div>
                                    <div class="role-arrow" ng-if="ndx != vm.workAudit.showNodes.length - 1">
                                        <i class="typeface-shengao_xiayige"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>